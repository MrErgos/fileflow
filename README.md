# Сервис временного хранения файлов

Веб-приложение на Java для загрузки файлов, обмена ими по уникальным ссылкам и отслеживания статистики скачиваний.

## Особенности реализации
- Пароли пользователей хранятся в зашифрованном виде с использованием BCrypt. Сессии управляются на стороне сервера.
- База данных SQLite для метаданных и локальная файловая система для самих файлов. Автоматическое создание таблиц через Flyway. sqlite может быть легко заменена на другую sql базу данных.
- Встроенный планировщик (Scheduler) удаляет файлы, срок хранения которых превысил 30 дней.
- Ограничение размера файлов до 100 МБ

## Требования для запуска
- **Java SDK 17** или выше
- **Apache Maven** (опционально, так как в проект включен `mvnw`)
- **Docker** (опционально, для запуска Redis)

## Инструкция по запуску

### 1. Сборка проекта
Из корневой директории проекта выполните команду:
```bash
./mvnw clean package
```
Для Windows(cmd):
```bash
mvnw.cmd clean package
```

### 2. Запуск приложения
После успешной сборки запустите программу командой:
```bash
java -jar target/fileflow-1.0-SNAPSHOT.jar
```
Примечание: При первом запуске приложение автоматически создаст файл базы данных storage.db и папку для хранения загруженных файлов.

После запуска приложение будет доступно по адресу: `http://localhost:8080/`

## Использование
Приложение предоставляет два интерфейса:

### Веб-интерфейс
Перейдите в браузере на http://localhost:8080/. 

1. Создайте аккаунт, чтобы получить доступ к личному кабинету.

2. Выберите файл и нажмите «Загрузить». Вы увидите прогресс-бар.

3. Под формой загрузки появится таблица с вашими файлами, где отображается:
   - Прямая ссылка на скачивание.
   - Тип файла
   - Размер файла
   - Количество скачиваний.
   - Дата загрузки и последнего обращения.

### REST API
#### Авторизация

POST /api/register или POST /api/login Параметры (Form Data): login, password.

Работа с файлами
- Чтобы загрузить файл - POST /api/upload (требуется авторизация). Поле в форме: newFile
- Чтобы скачать - GET /api/download/{id}
- Чтобы получить статистику - GET /api/stats — возвращает JSON со списком файлов пользователя

### Структура ответа (JSON)
Приложение возвращает объект с названием города и массивом данных:
```json
[
  {
    "url": "http://localhost:8080/api/download/25959b20-b0a3-4253-8bdc-97ecb7cd8a51",
    "originalName": "file.txt",
    "contentType": "*/*",
    "fileSize": 13,
    "downloadCount": 0,
    "uploadDate": "2026-02-01 17:47:33",
    "lastAccessAt": "2026-02-01 17:47:33"
  },
  ...
]
```